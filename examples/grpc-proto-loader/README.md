# grpc-proto-loader

This example shows how to use [`@grpc/proto-loader`](https://www.npmjs.com/package/@grpc/proto-loader) & [`@grpc/grpc-js`](https://www.npmjs.com/package/@grpc/grpc-js) to build a fully typed CLI chat application that runs on Node.js.

[`@grpc/proto-loader`](https://www.npmjs.com/package/@grpc/proto-loader) to used to [generate the  types](https://github.com/grpc/grpc-node/pull/1474) as well as load the protobuf files at runtime.

_No proto compiler is used. TypeScript files are generated by [`@grpc/proto-loader`](https://www.npmjs.com/package/@grpc/proto-loader) at build time, and protobufs are loaded at runtime using ([`protobuf.js`](https://www.npmjs.com/package/protobufjs) instead of [`google-protobuf`](https://www.npmjs.com/package/google-protobuf).)

## App layout

- [package.json](./package.json) - Dependencies and build scripts
- [proto/](./proto/) - Protobuf definitions and generated types
- [server.ts](./server.ts) - The grpc server
- [client.ts](./client.ts) - The grpc client

## Generating the Types

```sh
npm install
npm run build:proto
```

This will build TypeScript files from the proto files with the following command:

```sh
proto-loader-gen-types --keep-case --longs=String --enums=String --defaults --oneofs --grpcLib=@grpc/grpc-js --outDir=proto/ proto/*.proto
```

### Running the app

First build the types and application files:

```sh
npm run build
```

Start the server:

```sh
npm run start:server
```

Now run the client within different terminal sessions:

```bash
npm run start:client
```

## Credits

The chat application idea is inspired from https://techblog.fexcofts.com/2018/07/20/grpc-nodejs-chat-example/
